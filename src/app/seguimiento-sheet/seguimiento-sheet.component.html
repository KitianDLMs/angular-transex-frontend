<!-- OVERLAY -->
<div
  class="fixed inset-0 bg-black/40 z-40"
  (click)="onClose()">
</div>

<!-- MAPA + SHEET -->
<div class="fixed inset-0 z-50">
  
  <!-- MAPA -->
  <div #map class="absolute inset-0"></div>

  <!-- SHEET -->
  <section
    class="absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-2xl max-h-[65vh] overflow-y-auto">

    <!-- HANDLE -->
    <div class="flex justify-center py-2">
      <div class="w-10 h-1.5 bg-gray-300 rounded-full"></div>
    </div>

    <!-- INFO PRINCIPAL -->
    <div class="px-4 pb-4 space-y-3 text-sm">
      <div class="flex justify-between">
        <span class="text-gray-500">Pedido</span>
        <span class="font-medium">{{ ord.order_code }}</span>
      </div>

      <div class="flex justify-between">
        <span class="text-gray-500">Estado</span>
        <span class="font-medium">{{ estadoActual }}</span>
      </div>

      <div class="flex justify-between">
        <span class="text-gray-500">Producto</span>
        <span class="font-medium text-right max-w-[60%]">
          {{ ord.prod_descr }}
        </span>
      </div>

      <div class="flex justify-between">
        <span class="text-gray-500">Cantidad</span>
        <span class="font-medium">{{ ord.order_qty }} m³</span>
      </div>
    </div>

    <hr />

    <div class="p-4 space-y-6">

      <!-- ================= -->
      <!-- EN TRÁNSITO -->
      <!-- ================= -->
      <ng-container *ngIf="filasEnTransito.length">
        <h3 class="font-semibold text-gray-700">En tránsito</h3>

        <table class="w-full text-sm border">
          <tr class="bg-gray-100">
            <th class="p-2">Guía</th>
            <th class="p-2">Camión</th>
            <th class="p-2">Cantidad</th>
            <th class="p-2">Hora en obra</th>
          </tr>

          <tr *ngFor="let d of filasEnTransito">
            <td class="p-2">{{ d.guia }}</td>
            <td class="p-2">{{ d.camion }}</td>
            <td class="p-2">{{ d.cantidad }}</td>
            <td class="p-2">{{ d.hora_obra }}</td>
          </tr>
        </table>
      </ng-container>

      <!-- ================= -->
      <!-- COMPLETADO -->
      <!-- ================= -->
      <ng-container *ngIf="filasCompletadas.length">
        <h3 class="font-semibold text-gray-700">Completado</h3>

        <table class="w-full text-sm border">
          <tr class="bg-gray-100">
            <th class="p-2">Guía</th>
            <th class="p-2">Camión</th>
            <th class="p-2">Cantidad</th>
            <th class="p-2">Terminado</th>
          </tr>

          <tr *ngFor="let d of filasCompletadas">
            <td class="p-2">{{ d.guia }}</td>
            <td class="p-2">{{ d.camion }}</td>
            <td class="p-2">{{ d.cantidad }}</td>
            <td class="p-2">{{ d.hora_fin }}</td>
          </tr>
        </table>
      </ng-container>

    </div>

    <div class="p-4">
      <button
        class="w-full bg-cyan-700 text-white py-2 rounded-lg"
        (click)="onClose()">
        Cerrar
      </button>
    </div>

  </section>
</div>
